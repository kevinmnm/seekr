{
  "name": "Podcast Assessment Agent",
  "description": "Transforms raw podcast transcripts into marketing-ready briefs with summaries, highlights, and fact-check triage for the take-home assessment.",
  "active": true,
  "steps": [
    {
      "type": "start",
      "config": {
        "variables": [
          {
            "name": "episode_transcript",
            "value": ""
          },
          {
            "name": "episode_metadata",
            "value": "{\"title\":\"\",\"guests\":[],\"air_date\":\"\"}"
          },
          {
            "name": "knowledge_bank",
            "value": ""
          },
          {
            "name": "brand_voice",
            "value": "Succinct, insight-driven marketing tone suitable for a creative agency deliverable."
          }
        ]
      }
    },
    {
      "type": "llmInstruction",
      "config": {
        "instruction": "You are preparing raw podcast material for a downstream assessment.\n1. Review the transcript provided in ${episode_transcript} and lightly clean obvious transcription artefacts (duplicate timestamps, repeated filler words, garbled speaker tags) without inventing content.\n2. Produce a compact JSON payload with the following structure:\n{\n  \"normalized_transcript\": \"cleaned transcript text\",\n  \"episode_glossary\": [\n    { \"term\": \"\", \"meaning\": \"\" }\n  ],\n  \"watch_list\": [\n    \"short factual statements that require verification\"\n  ]\n}\n3. If the transcript is too short (< 500 characters), return {\"error\": \"INSUFFICIENT_TRANSCRIPT\"}.\n4. Incorporate helpful hints from metadata JSON in ${episode_metadata} when available.\nReturn only valid JSON.",
        "resultVariable": "normalized_payload"
      }
    },
    {
      "type": "llmInstruction",
      "config": {
        "instruction": "You are staging the podcast insights for marketing collateral.\nUsing ${normalized_payload.normalized_transcript} as the source content, craft a response that follows this JSON template:\n{\n  \"summary\": \"200-300 word narrative written in the ${brand_voice} tone. Emphasise the unique POV, guests, and outcomes.\",\n  \"key_takeaways\": [\n    \"Five concise, actionable bullet points phrased for busy marketers.\"\n  ],\n  \"notable_quotes\": [\n    { \"quote\": \"verbatim quote\", \"speaker\": \"name if available\", \"timestamp\": \"HH:MM:SS or 'unknown'\" }\n  ],\n  \"topics\": [ \"tag\" ],\n  \"fact_candidates\": ${normalized_payload.watch_list}\n}\nRespect the glossary from ${normalized_payload.episode_glossary} when choosing terminology. Return valid JSON only.",
        "resultVariable": "deliverables"
      }
    },
    {
      "type": "llmInstruction",
      "config": {
        "instruction": "Analyse each item inside ${deliverables.fact_candidates} against the verified references supplied in ${knowledge_bank}. For every claim, decide whether it is:\n- \"verified\" (evidence present in knowledge_bank),\n- \"outdated_or_inaccurate\" (conflicts with knowledge_bank), or\n- \"unverifiable\" (no supporting data; rely on reasoning only).\nReturn a JSON array named \"fact_matrix\" with rows shaped as:\n{\n  \"claim\": \"\",\n  \"status\": \"verified|outdated_or_inaccurate|unverifiable\",\n  \"method\": \"knowledge_base|reasoning|external_search\",\n  \"notes\": \"short rationale\",\n  \"confidence\": 0.0-1.0\n}\nIf knowledge_bank is empty, set method to \"reasoning\" and lower confidence accordingly. Always return valid JSON.",
        "resultVariable": "fact_matrix"
      }
    },
    {
      "type": "llmInstruction",
      "config": {
        "instruction": "Assemble the final client-ready briefing in Markdown.\nRequired sections:\n1. Title line using ${episode_metadata.title} when present (fallback \"Podcast Episode\").\n2. Summary paragraph from ${deliverables.summary}.\n3. \"Top 5 Takeaways\" bullet list sourced from ${deliverables.key_takeaways}.\n4. \"Notable Quotes\" block quoting each entry in ${deliverables.notable_quotes} with speakers and timestamps.\n5. \"Topics Discussed\" inline list using ${deliverables.topics}.\n6. \"Fact Check Review\" table using ${fact_matrix} with columns Claim | Status | Method | Notes | Confidence.\n7. Append a \"Glossary\" section if ${normalized_payload.episode_glossary} is non-empty.\nEnsure the Markdown is tidy, uses bold headings, and mirrors the ${brand_voice}.",
        "resultVariable": "podcast_brief_markdown",
        "directOutput": true
      }
    }
  ]
}
